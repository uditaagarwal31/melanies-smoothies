create database SMOOTHIES;

use schema SMOOTHIES.PUBLIC;
use role SYSADMIN;
create or replace table SMOOTHIES.PUBLIC.FRUIT_OPTIONS 
(fruit_id number,
fruit_name varchar(25)
);

create file format smoothies.public.two_headerrow_pct_delim
   type = CSV,
   skip_header = 2,   
   field_delimiter = '%',
   trim_space = TRUE
;

SELECT $1, $2, $3, $4, $5
FROM @smoothies.public.my_uploaded_files/fruits_available_for_smoothies.txt
(FILE_FORMAT => smoothies.public.two_headerrow_pct_delim);

COPY INTO smoothies.public.fruit_options
from (select $2 as fruit_id, $1 as fruit_name from @smoothies.public.my_uploaded_files/fruits_available_for_smoothies.txt)
file_format = (format_name = smoothies.public.two_headerrow_pct_delim)
on_error = abort_statement
purge = true;

select * from SMOOTHIES.PUBLIC.FRUIT_OPTIONS;

use role SYSADMIN;

create or replace table SMOOTHIES.PUBLIC.ORDERS 
(
ingredients varchar(200)
);

SELECT * FROM SMOOTHIES.PUBLIC.fruit_options; 

truncate table SMOOTHIES.PUBLIC.ORDERS; 


alter table SMOOTHIES.PUBLIC.ORDERS add column name_on_order varchar(100);

alter table SMOOTHIES.PUBLIC.fruit_options add column search_on varchar(100);

update SMOOTHIES.PUBLIC.fruit_options set search_on = fruit_name;

update SMOOTHIES.PUBLIC.fruit_options 
set search_on = 'Strawberry' 
where fruit_name = 'Strawberries';

INSERT INTO SMOOTHIES.PUBLIC.ORDERS (INGREDIENTS, NAME_ON_ORDER) VALUES ('Apples Cantaloupe Blueberries Figs Elderberries ','Udita')


alter table SMOOTHIES.PUBLIC.ORDERS add column order_filled boolean default false;

       update smoothies.public.orders
       set order_filled = true
       where name_on_order is null;

alter table SMOOTHIES.PUBLIC.ORDERS add column order_uid integer default smoothies.public.order_seq.nextval
constraint order_uid unique enforced;

use role SYSADMIN;
create or replace table smoothies.public.orders (
       order_uid integer default smoothies.public.order_seq.nextval,
       order_filled boolean default false,
       name_on_order varchar(100),
       ingredients varchar(200),
       constraint order_uid unique (order_uid),
       order_ts timestamp_ltz default current_timestamp()
);

create function sum_mystery_bag_vars (var1 number, var2 number, var3 number)
    returns number as 'select var1+var2+var3';

select sum_mystery_bag_vars(12,-10,-5);

set alternating_caps_phrase = 'aLterNatiNg CApS';
select $alternating_caps_phrase;
select initcap($alternating_caps_phrase);


create function NEUTRALIZE_WHINING (var1 text)
    returns text as 'select initcap(var1)';

select NEUTRALIZE_WHINING('tELLEphoneS!');
